{"version":3,"sources":["../../../../../frontend/app/stocks/detail/StockDetailClient.js"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback } from \"react\";\nimport { useAuth } from \"@/context/AuthContext\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport PriceChart from \"@/components/PriceChart\";\nimport { STOCKS, getBarParams, getCompanyInfo } from \"@/lib/assets\";\nimport { ArrowLeft, X, CheckCircle2, Loader2 } from \"lucide-react\";\nimport PinModal from \"@/components/PinModal\";\nimport Keypad from \"@/components/Keypad\";\nimport { useToast } from \"@/components/Toast\";\nimport api from \"@/lib/api\";\nimport { playKaChing } from \"@/lib/sound\";\n\nconst TIME_RANGES = [\"1D\", \"1W\", \"1M\", \"1Y\", \"ALL\"];\nconst PRESET_AMOUNTS = [1, 10, 20, 50, 100];\n\nexport default function StockDetailPage() {\n  const { user, loading } = useAuth();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const toast = useToast();\n  const symbol = searchParams.get(\"symbol\")?.toUpperCase();\n\n  const stock = STOCKS.find((s) => s.symbol === symbol);\n\n  const [timeRange, setTimeRange] = useState(\"1D\");\n  const [showBuy, setShowBuy] = useState(false);\n  const [showSell, setShowSell] = useState(false);\n  const [showConfirm, setShowConfirm] = useState(false);\n  const [showKeypad, setShowKeypad] = useState(false);\n  const [amount, setAmount] = useState(\"\");\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const [orderType, setOrderType] = useState(\"buy\");\n  const [isPinOpen, setIsPinOpen] = useState(false);\n\n  // Live Data State\n  const [priceData, setPriceData] = useState({\n    price: 0,\n    change: 0,\n    isUp: true,\n  });\n  const [chartData, setChartData] = useState([]);\n  const [position, setPosition] = useState({ qty: 0, market_value: 0 });\n  const [cashBalance, setCashBalance] = useState(0);\n  const [dataLoading, setDataLoading] = useState(true);\n\n  const shareQty = position.qty;\n  const shareValue = position.market_value;\n\n  useEffect(() => {\n    if (!loading && !user) router.push(\"/login\");\n  }, [user, loading, router]);\n\n  // Fetch live quote & position\n  const fetchData = useCallback(async () => {\n    if (!symbol) return;\n    try {\n      // 1. Quote\n      const quoteRes = await api.get(`/trading/quote/${symbol}`);\n      const q = quoteRes.data.data;\n      const currentPrice = q.price;\n      const openPrice = q.open || q.prevClose || currentPrice;\n\n      const diff = currentPrice - openPrice;\n      const pctChange = openPrice ? (diff / openPrice) * 100 : 0;\n\n      setPriceData({\n        price: currentPrice,\n        change: pctChange,\n        isUp: pctChange >= 0,\n      });\n\n      // 2. Position\n      const posRes = await api.get(\n        `/trading/positions/${stock.alpacaSymbol || symbol}`,\n      );\n      if (posRes.data.success && posRes.data.data) {\n        setPosition(posRes.data.data);\n      }\n\n      // 3. Cash Balance\n      const balRes = await api.get(\"/wallet/balance\");\n      if (balRes.data.success) {\n        setCashBalance(balRes.data.data.balance / 100);\n      }\n    } catch (err) {\n      console.error(\n        \"Failed to fetch stock data:\",\n        err.response?.data || err.message,\n      );\n    }\n  }, [symbol, stock]);\n\n  // Fetch historical chart bars\n  const fetchChart = useCallback(async () => {\n    if (!symbol) return;\n    try {\n      const { timeframe, start, limit } = getBarParams(timeRange);\n      const res = await api.get(`/trading/bars/${symbol}`, {\n        params: { timeframe, start, limit },\n      });\n      const bars = res.data.data.bars || [];\n\n      const formatted = bars.map((b) => parseFloat(b.c));\n\n      if (formatted.length > 0) {\n        setChartData(formatted);\n      }\n    } catch (err) {\n      console.error(\n        \"Failed to fetch stock chart:\",\n        err.response?.data || err.message,\n      );\n    }\n  }, [symbol, timeRange]);\n\n  useEffect(() => {\n    if (!user || !stock) return;\n    setDataLoading(true);\n    Promise.all([fetchData(), fetchChart()]).finally(() =>\n      setDataLoading(false),\n    );\n  }, [user, stock, timeRange, fetchData, fetchChart]);\n\n  if (!stock) {\n    return (\n      <div className=\"min-h-screen bg-white dark:bg-black flex items-center justify-center\">\n        <p className=\"text-gray-500\">Stock not found</p>\n      </div>\n    );\n  }\n\n  const [orderStatusMsg, setOrderStatusMsg] = useState(\"Filled\");\n\n  const handleConfirm = async () => {\n    const amt = parseFloat(amount);\n    if (!amt || amt <= 0) return;\n\n    setIsProcessing(true);\n    try {\n      const res = await api.post(\"/trading/order\", {\n        symbol,\n        notional: amt,\n        side: orderType,\n      });\n      const orderStatus = res.data.data?.status;\n\n      // Refresh position\n      await fetchData();\n\n      setIsProcessing(false);\n      setOrderStatusMsg(\n        orderStatus === \"accepted\" || orderStatus === \"new\"\n          ? \"Queued (Market Closed)\"\n          : \"Filled\",\n      );\n      playKaChing();\n      setSuccess(true);\n      setTimeout(() => {\n        setSuccess(false);\n        setShowConfirm(false);\n        setShowBuy(false);\n        setShowSell(false);\n        setAmount(\"\");\n      }, 1800);\n    } catch (err) {\n      setIsProcessing(false);\n      toast.error(\"Order failed: \" + (err.response?.data?.message || err.message));\n      setShowConfirm(false);\n    }\n  };\n\n  const openBuy = () => {\n    setOrderType(\"buy\");\n    setAmount(\"\");\n    setShowBuy(true);\n    setShowKeypad(false);\n  };\n  const openSell = () => {\n    setOrderType(\"sell\");\n    setAmount(\"\");\n    setShowSell(true);\n    setShowKeypad(false);\n  };\n  const goToConfirm = () => {\n    const amt = parseFloat(amount);\n    if (amt && amt > 0) {\n      setShowBuy(false);\n      setShowSell(false);\n      setShowConfirm(true);\n    }\n  };\n\n  if (loading || !user) return null;\n\n  const amt = parseFloat(amount) || 0;\n  const estQty = priceData.price ? amt / priceData.price : 0;\n  const companyInfo = getCompanyInfo(stock.symbol, stock.name);\n\n  return (\n    <div className=\"min-h-screen bg-white dark:bg-black pb-24\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between p-6\">\n        <button\n          onClick={() => router.back()}\n          className=\"p-2 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-full transition-all\"\n        >\n          <ArrowLeft className=\"w-6 h-6\" />\n        </button>\n        <div className=\"w-10\" />\n      </div>\n\n      {/* Asset Info */}\n      <div className=\"px-6\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <div className=\"flex items-center space-x-4\">\n            <div\n              className=\"w-14 h-14 rounded-full flex items-center justify-center text-2xl font-bold\"\n              style={{ backgroundColor: stock.color + \"20\" }}\n            >\n              {stock.icon}\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold\">{stock.name}</h1>\n              {dataLoading ? (\n                <div className=\"h-4 w-16 bg-gray-200 dark:bg-zinc-800 animate-pulse rounded mt-1\" />\n              ) : (\n                <p\n                  className={`text-sm font-bold ${priceData.isUp ? \"text-cashapp\" : \"text-red-500\"}`}\n                >\n                  {priceData.isUp ? \"↑\" : \"↓\"}{\" \"}\n                  {Math.abs(priceData.change).toFixed(2)}%\n                </p>\n              )}\n            </div>\n          </div>\n          <div className=\"bg-gray-100 dark:bg-zinc-800 px-4 py-2 rounded-full\">\n            {dataLoading ? (\n              <div className=\"h-6 w-16 bg-gray-200 dark:bg-zinc-700 animate-pulse rounded\" />\n            ) : (\n              <p className=\"text-lg font-bold\">\n                $\n                {priceData.price.toLocaleString(undefined, {\n                  minimumFractionDigits: 2,\n                  maximumFractionDigits: 2,\n                })}\n              </p>\n            )}\n          </div>\n        </div>\n\n        {/* Holdings */}\n        {shareQty > 0 && !dataLoading && (\n          <div className=\"mt-4 p-4 bg-gray-50 dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800\">\n            <p className=\"text-xs text-gray-500 font-bold uppercase tracking-widest\">\n              Your Position\n            </p>\n            <p className=\"text-xl font-bold mt-1\">\n              {shareQty.toFixed(4)} Shares\n            </p>\n            <p className=\"text-sm text-gray-500\">\n              ≈ $\n              {shareValue.toLocaleString(undefined, {\n                minimumFractionDigits: 2,\n                maximumFractionDigits: 2,\n              })}\n            </p>\n          </div>\n        )}\n      </div>\n\n      {/* Chart */}\n      <div className=\"px-2 mt-6 relative\">\n        {dataLoading && chartData.length === 0 ? (\n          <div className=\"h-[220px] flex items-center justify-center\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-gray-300\" />\n          </div>\n        ) : (\n          <PriceChart data={chartData} color={stock.color} height={220} />\n        )}\n      </div>\n\n      {/* Time Range Tabs */}\n      <div className=\"flex justify-center space-x-2 px-6 mt-4 mb-8\">\n        {TIME_RANGES.map((t) => (\n          <button\n            key={t}\n            onClick={() => setTimeRange(t)}\n            className={`px-4 py-2 rounded-full text-sm font-bold transition-all ${timeRange === t\n              ? \"bg-black dark:bg-white text-white dark:text-black\"\n              : \"text-gray-400 hover:text-gray-600\"\n              }`}\n          >\n            {t}\n          </button>\n        ))}\n      </div>\n\n      {/* About Company */}\n      <div className=\"px-6 mb-8 mt-6\">\n        <h3 className=\"text-xl font-bold mb-4\">About</h3>\n        <p className=\"text-gray-500 text-sm leading-relaxed mb-6\">\n          {companyInfo.about}\n        </p>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"p-4 bg-gray-50 dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800\">\n            <p className=\"text-xs text-gray-500 font-bold uppercase tracking-widest mb-1\">\n              CEO\n            </p>\n            <p className=\"font-bold text-sm\">{companyInfo.ceo}</p>\n          </div>\n          <div className=\"p-4 bg-gray-50 dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800\">\n            <p className=\"text-xs text-gray-500 font-bold uppercase tracking-widest mb-1\">\n              Employees\n            </p>\n            <p className=\"font-bold text-sm\">{companyInfo.employees}</p>\n          </div>\n          <div className=\"col-span-2 p-4 bg-gray-50 dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800\">\n            <p className=\"text-xs text-gray-500 font-bold uppercase tracking-widest mb-1\">\n              Headquarters\n            </p>\n            <p className=\"font-bold text-sm\">{companyInfo.hq}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Buy / Sell Buttons */}\n      <div className=\"fixed bottom-0 left-0 right-0 max-w-md mx-auto p-6 bg-white/80 dark:bg-black/80 backdrop-blur-md border-t border-gray-100 dark:border-zinc-800\">\n        <div className=\"flex space-x-3\">\n          <button\n            onClick={openBuy}\n            className=\"flex-1 bg-black dark:bg-white text-white dark:text-black font-bold py-4 rounded-full text-lg hover:scale-[1.02] active:scale-95 transition-all\"\n          >\n            Buy\n          </button>\n          <button\n            onClick={openSell}\n            disabled={shareQty <= 0}\n            className=\"flex-1 bg-gray-100 dark:bg-zinc-800 font-bold py-4 rounded-full text-lg hover:scale-[1.02] active:scale-95 transition-all disabled:opacity-50\"\n          >\n            Sell\n          </button>\n        </div>\n      </div>\n\n      {/* Buy/Sell Sheet */}\n      {(showBuy || showSell) && (\n        <div\n          className=\"fixed inset-0 z-50 flex items-end justify-center bg-black/50\"\n          onClick={() => {\n            setShowBuy(false);\n            setShowSell(false);\n          }}\n        >\n          <div\n            className=\"w-full max-w-md bg-white dark:bg-zinc-900 rounded-t-3xl p-6 animate-in slide-in-from-bottom duration-300\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"flex justify-center mb-4\">\n              <div className=\"w-12 h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full\" />\n            </div>\n\n            <h2 className=\"text-xl font-bold text-center mb-1\">\n              {orderType === \"buy\" ? \"Buy\" : \"Sell\"} {stock.name}\n            </h2>\n            <div className=\"flex justify-center mb-2\">\n              <span className=\"text-gray-500 font-medium text-sm\">\n                $\n                {orderType === \"buy\"\n                  ? cashBalance.toLocaleString()\n                  : shareValue.toLocaleString(undefined, {\n                    minimumFractionDigits: 2,\n                    maximumFractionDigits: 2,\n                  })}{\" \"}\n                Available\n              </span>\n            </div>\n            <div className=\"flex justify-center mb-6 mt-4\">\n              <span className=\"px-4 py-1.5 bg-gray-100 dark:bg-zinc-800 rounded-full text-sm font-medium\">\n                One-Time Purchase ▾\n              </span>\n            </div>\n\n            {showKeypad ? (\n              <div className=\"animate-in fade-in duration-200\">\n                <div className=\"text-center text-4xl font-bold mb-6 mt-4\">\n                  ${amount || \"0\"}\n                </div>\n                <Keypad amount={amount} setAmount={setAmount} />\n                <button\n                  onClick={() => setShowKeypad(false)}\n                  className=\"w-full mt-6 py-4 text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-zinc-800 rounded-full transition-all\"\n                >\n                  Cancel Custom Amount\n                </button>\n              </div>\n            ) : (\n              <>\n                {/* Preset Amounts */}\n                <div className=\"grid grid-cols-3 gap-3 mb-6\">\n                  {PRESET_AMOUNTS.map((a) => (\n                    <button\n                      key={a}\n                      onClick={() => setAmount(String(a))}\n                      className={`py-4 rounded-2xl font-bold text-lg transition-all border ${amount === String(a)\n                        ? \"border-black dark:border-white bg-gray-50 dark:bg-zinc-800\"\n                        : \"border-gray-200 dark:border-zinc-700 hover:border-gray-400\"\n                        }`}\n                    >\n                      ${a}\n                    </button>\n                  ))}\n                  <button\n                    onClick={() => {\n                      setShowKeypad(true);\n                      setAmount(\"\");\n                    }}\n                    className={`py-4 rounded-2xl font-bold text-lg transition-all border ${amount && !PRESET_AMOUNTS.includes(Number(amount))\n                      ? \"border-black dark:border-white bg-gray-50 dark:bg-zinc-800\"\n                      : \"border-gray-200 dark:border-zinc-700 hover:border-gray-400\"\n                      }`}\n                  >\n                    {amount && !PRESET_AMOUNTS.includes(Number(amount))\n                      ? `$${amount}`\n                      : \"...\"}\n                  </button>\n                </div>\n              </>\n            )}\n\n            {orderType === \"buy\" &&\n              (!amount || parseFloat(amount) > cashBalance) &&\n              amount !== \"\" && (\n                <p className=\"text-red-500 text-sm text-center mt-4 mb-2 font-medium\">\n                  Amount exceeds your cash balance ($\n                  {cashBalance.toLocaleString(undefined, {\n                    minimumFractionDigits: 2,\n                    maximumFractionDigits: 2,\n                  })}\n                  )\n                </p>\n              )}\n            {orderType === \"sell\" &&\n              (!amount || parseFloat(amount) > shareValue) &&\n              amount !== \"\" && (\n                <p className=\"text-red-500 text-sm text-center mt-4 mb-2 font-medium\">\n                  Amount exceeds your stock balance ($\n                  {shareValue.toLocaleString(undefined, {\n                    minimumFractionDigits: 2,\n                    maximumFractionDigits: 2,\n                  })}\n                  )\n                </p>\n              )}\n\n            <button\n              onClick={goToConfirm}\n              disabled={\n                !amount ||\n                parseFloat(amount) <= 0 ||\n                (orderType === \"sell\" && parseFloat(amount) > shareValue) ||\n                (orderType === \"buy\" && parseFloat(amount) > cashBalance)\n              }\n              className={`w-full mt-4 bg-cashapp text-white font-bold py-4 rounded-full text-lg shadow-lg disabled:opacity-30 disabled:shadow-none hover:scale-[1.02] active:scale-95 transition-all ${showKeypad ? \"\" : \"\"}`}\n            >\n              Next\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Confirm Sheet */}\n      {showConfirm && (\n        <div className=\"fixed inset-0 z-50 flex flex-col bg-white dark:bg-black\">\n          <div className=\"flex justify-end p-6\">\n            <button\n              onClick={() => {\n                setShowConfirm(false);\n                setAmount(\"\");\n              }}\n              className=\"p-2 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-full transition-all\"\n            >\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          {success ? (\n            <div className=\"flex-1 flex flex-col items-center justify-center\">\n              <CheckCircle2 className=\"w-20 h-20 text-cashapp mb-4 animate-bounce\" />\n              <h2 className=\"text-2xl font-bold\">Order Placed!</h2>\n              <p className=\"text-gray-500 mt-2 font-medium\">\n                {orderStatusMsg} • {orderType === \"buy\" ? \"Bought\" : \"Sold\"} $\n                {amt.toFixed(2)} of {stock.name}\n              </p>\n              <button\n                onClick={() => router.push(\"/stocks\")}\n                className=\"mt-8 text-black dark:text-white font-bold underline\"\n              >\n                Back to Stocks\n              </button>\n            </div>\n          ) : (\n            <div className=\"flex-1 flex flex-col justify-between px-8 pb-8\">\n              <div>\n                <h2 className=\"text-3xl font-bold mb-10\">\n                  {orderType === \"buy\" ? \"Buy\" : \"Sell\"} ${amt.toFixed(2)} of{\" \"}\n                  {stock.name}\n                </h2>\n\n                <div className=\"space-y-4\">\n                  {[\n                    { label: \"Funding Source\", value: \"FlowCash\" },\n                    { label: \"Order Type\", value: \"Market\" },\n                    {\n                      label: \"Approx Price\",\n                      value: `$${priceData.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`,\n                    },\n                    { label: \"Approx Shares\", value: `${estQty.toFixed(4)}` },\n                    { label: \"Symbol\", value: stock.symbol },\n                  ].map((row) => (\n                    <div key={row.label} className=\"flex justify-between py-2\">\n                      <span className=\"text-gray-500\">{row.label}</span>\n                      <span className=\"font-bold\">{row.value}</span>\n                    </div>\n                  ))}\n\n                  <div className=\"border-t border-gray-100 dark:border-zinc-800 pt-4 mt-4 space-y-3\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500\">Total Amount</span>\n                      <span className=\"font-bold\">${amt.toFixed(2)}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500\">Fees</span>\n                      <span className=\"font-bold\">$0.00</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500 font-bold\">\n                        Total Cost\n                      </span>\n                      <span className=\"font-bold text-lg\">\n                        ${amt.toFixed(2)}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <button\n                onClick={() => setIsPinOpen(true)}\n                disabled={isProcessing}\n                className=\"w-full bg-black dark:bg-white text-white dark:text-black font-bold py-5 rounded-full text-lg hover:scale-[1.02] active:scale-95 transition-all disabled:opacity-50\"\n              >\n                {isProcessing ? (\n                  <Loader2 className=\"w-6 h-6 animate-spin mx-auto\" />\n                ) : (\n                  \"Confirm\"\n                )}\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n\n      <PinModal\n        isOpen={isPinOpen}\n        onSuccess={() => {\n          setIsPinOpen(false);\n          handleConfirm();\n        }}\n        onClose={() => setIsPinOpen(false)}\n        userId={user?.id}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}